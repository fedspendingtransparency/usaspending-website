$grants-line-color: #47AAA7;
$loans-line-color: #F5A623;

$obligated: #0A2F5A;
$current: #558EC6;
$potential: #AAC6E2;

$file-c-outlay: #6E338E;
$file-c-obligation: #B699C6;

%award-amounts-viz__line-indicator {
    content: "";
    position: absolute;
    width: rem(1);
    height: rem(10);
}

.award-amounts-viz {
    // Tooltip rules.
    .award-amounts-tt__wrapper {
        position: relative;
        z-index: 4;
    }
    // Parent element for the Bars Viz, not their labels or text.
    .award-amounts-viz__bar-container {
        border: rem(2) solid $color-gray;
        background-color: $color-white;
        margin: rem(16) 0 0 0;
        padding: rem(3);
        &.idv-extreme-overspending-obligated,
        &.contract-extreme-overspending-obligated {
            border: none;
        }
        .award-amounts-viz__bar-wrapper {
            // denominators have a fixed height.
            &.contract-potential,
            &.idv-potential,
            &.loan-face-value,
            &.contract-extreme-overspending-obligated,
            &.idv-extreme-overspending-obligated,
            &.asst-total-funding {
                height: rem(50);
            }
            // all other bars should just have the height of their parent.
            height: 100%;
        }

        .award-amounts-viz__bar {
            height: 100%;
            background-color: #ececec;
            @include display(flex);
            .nested-obligations {
                padding: rem(2);
                width: 100%;
                @include display(flex);
            }
            &.idv-overspending,
            &.contract-overspending {
                border-top: .4rem solid $color-gray-lightest;
                border-bottom: .4rem solid $color-gray-lightest;
                background: repeating-linear-gradient(45deg,#4773aa,#4773aa .8rem,#fdb81e 0,#fdb81e 1rem);
                &.covid {
                    border-top: .4rem solid $potential;
                    border-bottom: .4rem solid $potential;
                }
            }
            .award-amounts-viz__bar-wrapper {
                &.idv-extreme-overspending-potential-wrapper,
                &.contract-extreme-overspending-potential-wrapper {
                    border: 0.2rem solid #5b616b;
                    background-color: #fff;
                    .award-amounts-viz__bar .nested-obligations .award-amounts-viz__bar,
                    .award-amounts-viz__bar .nested-obligations .award-amounts-viz__bar {
                        &.contract-extreme-overspending-current,
                        &.idv-extreme-overspending-current {
                            border: solid 0.4rem $color-gray-lighter;
                        }
                        &.covid.contract-extreme-overspending-current,
                        &.covid.idv-extreme-overspending-current {
                            border: solid 0.4rem $current;
                        }
                        &.contract-extreme-overspending-potential,
                        &.idv-extreme-overspending-potential {
                            border-top: 4px solid white;
                            border-bottom: 4px solid white;
                        }
                    }
                }
                &.contract-extreme-overspending,
                &.idv-extreme-overspending {
                    @include display(flex);
                    @include align-items(center);
                }
            }

            &.idv-overspending-current,
            &.contract-overspending-current {
                border: rem(4) solid $color-gray-lighter;
            }

            &.idv-extreme-overspending,
            &.contract-extreme-overspending {
                height: rem(40);
                background: repeating-linear-gradient(45deg, #4773aa, #4773aa 0.8rem, #e31c3d 0.2rem, #e31c3d 1rem);
                border-top: solid 0.4rem #fff;
                border-bottom: solid 0.4rem #fff;
            }
            
            &.asst-non-federal-funding {
                position: relative;
                padding: rem(3.5);
            }
        }
    }
    // Parent element for the individual Bar Description -- including line, legend, and text.
    .award-amounts-viz__desc-container {
        @include display(flex);
        @include align-items(flex-end);
        @include flex-direction(column);
        
        .award-amounts-viz__label {
            width: 100%;
        }
        .award-amounts-viz__desc {
            padding-left: rem(5);
            margin-bottom: rem(5);
            text-align: right;
        }
        &.top {
            @include align-items(flex-start);
            margin-bottom: rem(5);
            .improper {
                width: 100%;
                @include display(flex);
                margin-bottom: rem(5);
                .idv-extreme-overspending-label,
                .contract-extreme-overspending-label,
                .idv-overspending-obligated,
                .contract-overspending-obligated {
                    text-align: right;
                    @include justify-content(flex-end);
                    border-left: none;
                    padding-right: rem(5);
                    &.contract-overspending-obligated::after,
                    &.idv-overspending-obligated::after {
                        content: ' ';
                        width: rem(5);
                        height: rem(55);
                        border: solid rem(1) #fdb81e;
                        background: repeating-linear-gradient(45deg, #fff, #fff 0.5rem, #fdb81e 0.2rem, #fdb81e 0.7rem);
                        margin-left: rem(5);                        
                    }
                    &.contract-extreme-overspending-label::after,
                    &.idv-extreme-overspending-label::after {
                        content: ' ';
                        width: rem(5);
                        height: rem(55);
                        border: solid 0.1rem #e31c3d;
                        background: repeating-linear-gradient(45deg, #fff, #fff 0.5rem, #e31c3d 0.2rem, #e31c3d 0.7rem);
                        margin-left: rem(5);                        
                    }
                }
            }
            .award-amounts-viz__desc {
                // Description above Viz.
                @include display(flex);
                @include justify-content(space-between);
                @include align-items(flex-end);
                font-size: $base-font-size;
                color: $color-gray;
                border-left: solid rem(4) $color-cool-blue-light;
                width: auto;
                text-align: left;
                @include flex(1 1 auto);
                margin-bottom: 0;
                &.idv-file-c-obligated,
                &.contract-file-c-obligated,
                &.loan-file-c-obligated,
                &.asst-file-c-obligated {
                    border-left: solid rem(4) $file-c-obligation;
                    margin-top: rem(17);
                    strong {
                        font-size: $h6-font-size;
                    }
                }
                &.loan-subsidy {
                    border-left: solid rem(4) $loans-line-color;
                    flex-wrap: wrap;
                    span {
                        // this span is only present when the loans subsidy amount is zero
                        margin: auto;
                        width: 100%;
                    }
                }
                strong {
                    font-size: $h4-font-size;
                }
                br {
                    font-size: $small-font-size;
                }
            }
            .award-amounts-viz__label {
                .award-amounts-viz__line {
                    margin: rem(5) 0 rem(5) rem(1);
                    position: relative;
                    width: 99.5%;
                    height: rem(1);
                    border-bottom: rem(1) solid $color-cool-blue-light;
                    &::after {
                        @extend %award-amounts-viz__line-indicator;
                        border-left: rem(1) solid $color-cool-blue-light;
                        top: 0px;
                        right: -1px;
                    }
                    &::before {
                        @extend %award-amounts-viz__line-indicator;
                        border-left: rem(1) solid $color-cool-blue-light;
                        top: 0px;
                        left: -1px;
                    }
                    &.covid::before,
                    &.covid::after {
                        border-left: rem(1) solid $obligated;
                    }
                    &.covid {
                        border-bottom: rem(1) solid $obligated;
                    }
                    &.idv-file-c-obligated,
                    &.contract-file-c-obligated,
                    &.asst-file-c-obligated,
                    &.loan-file-c-obligated {
                        border-bottom: rem(1) solid $file-c-obligation;
                        &::before,
                        &::after {
                            border-left: rem(1) solid $file-c-obligation;
                        }
                    }
                    &.loan-subsidy {
                        border-bottom: rem(1) solid $loans-line-color;
                        &::before {
                            @extend %award-amounts-viz__line-indicator;
                            top: 0px;
                            left: -1px;
                            border-left: rem(1) solid $loans-line-color;
                        }
                        &::after {
                            border-left: rem(1) solid $loans-line-color;
                        }
                    }
                }
            }
        }
        &.bottom {
            @include align-items(flex-start);
            .award-amounts-viz__label {
                text-align: center;
                margin-bottom: 0;
                &.idv-file-c-outlay,
                &.contract-file-c-outlay,
                &.loan-file-c-outlay {
                    text-align: left;
                    width: 100%;
                }
                &.asst-non-federal-funding {
                    @include display(flex);
                    @include flex-direction(column);
                    @include align-items(flex-end);
                }
                .award-amounts-viz__desc {
                    @include display(flex);
                    &:not(.covid) {
                        &.contract-current,
                        &.idv-current {
                            border-right: rem(5) solid $color-gray-lighter;
                        }
                        &.idv-potential::after,
                        &.contract-potential::after,
                        &.idv-overspending-potential::after,
                        &.contract-overspending-potential::after,
                        &.idv-extreme-overspending-potential::after,
                        &.contract-extreme-overspending-potential::after {
                            content: ' ';
                            height: rem(45);
                            border: rem(1) solid $color-gray;
                            background-color: #ECECDC;
                            width: rem(5);
                        }
                        &.non-federal-funding {
                            border-right: rem(5) solid $grants-line-color;
                        }
                    }
                    &.covid {
                        &.contract-current,
                        &.idv-current,
                        &.contract-overspending-current,
                        &.idv-overspending-current,
                        &.contract-extreme-overspending-current,
                        &.idv-extreme-overspending-current {
                            border-right: 5px solid $current;
                        }
                        &.idv-potential,
                        &.contract-potential,
                        &.idv-overspending-potential,
                        &.contract-overspending-potential,
                        &.idv-extreme-overspending-potential,
                        &.contract-extreme-overspending-potential {
                            border-right: 5px solid $potential;
                        }
                    }
                    .award-amounts-viz__desc-text {
                        @include flex(1 1 auto);
                        font-size: $base-font-size;
                        color: $color-gray;
                        text-align: right;
                        padding-right: rem(10);
                        strong {
                            font-size: $lead-font-size;
                        }
                        .award-amounts-viz__desc-text-wrapper {
                            @include display(flex);
                            @include justify-content(flex-end);
                            @include align-items(center);
                            .award__info-wrapper {
                                margin-right: rem(5);
                            }
                        }
                    }
                    &.contract-file-c-outlay,
                    &.loan-file-c-outlay,
                    &.idv-file-c-outlay,
                    &.asst-file-c-outlay {
                        border-left: rem(4) solid $file-c-outlay;
                        .award-amounts-viz__desc-text {
                            text-align: left;
                            padding-left: rem(5);
                            strong {
                                font-size: $h6-font-size;
                            }
                        }
                    }
                    &.loan-face-value::after,
                    &.asst-total-funding::after {
                        content: ' ';
                        height: rem(45);
                        border: rem(1) solid $color-gray;
                        width: rem(5);
                    }
                }
                .award-amounts-viz__line {
                    margin: rem(20) 0 rem(5) rem(1);
                    border-bottom: rem(1) solid $color-gray-lighter;
                    position: relative;
                    width: 99.5%;
                    height: rem(1);
                    &::after,
                    &::before {
                        @extend %award-amounts-viz__line-indicator;
                        border-left: rem(1) solid $color-gray-lighter;
                        top: -9px;
                        right: -1px;
                    }
                    &::before {
                        left: -1px;
                    }
                    &.contract-file-c-outlay::after,
                    &.contract-file-c-outlay::before,
                    &.idv-file-c-outlay::after,
                    &.idv-file-c-outlay::before,
                    &.asst-file-c-outlay::after,
                    &.asst-file-c-outlay::before,
                    &.loan-file-c-outlay::after,
                    &.loan-file-c-outlay::before  {
                        border-left: rem(1) solid $file-c-outlay;
                    }
        
                    &.asst-non-federal-funding {
                        border-bottom: 1px solid $grants-line-color;
                        &::before {
                            @extend %award-amounts-viz__line-indicator;
                            top: -9px;
                            right: -1px;
                            left: -1px;
                            border-left: 1px solid $grants-line-color;
                        }
                        &::after {
                            @extend %award-amounts-viz__line-indicator;
                            top: -9px;
                            right: -1px;
                            border-left: 1px solid $grants-line-color; 
                        }
                    }
                    &.covid.contract-current {
                        border-bottom: rem(1) solid $current;
                        &::after,
                        &::before {
                            border-left: rem(1) solid $current;
                        }
                    }
                    &.covid.idv-potential,
                    &.covid.contract-potential {
                        border-bottom: rem(1) solid $potential;
                        &::before,
                        &::after {
                            border-left: rem(1) solid $potential;
                        }
                    }
                    &.contract-file-c-outlay,
                    &.idv-file-c-outlay,
                    &.asst-file-c-outlay,
                    &.loan-file-c-outlay {
                        border-bottom: rem(1) solid $file-c-outlay;
                        &::before,
                        &::after {
                            border-left: rem(1) solid $file-c-outlay;
                        }
                    }
                }
            }
            .award-amounts-viz__desc.asst-nff-zero,
            .award-amounts-viz__desc.loan-file-c-outlay--zero,
            .award-amounts-viz__desc.idv-file-c-outlay--zero,
            .award-amounts-viz__desc.contract-file-c-outlay--zero,
            .award-amounts-viz__desc.asst-file-c-outlay--zero {
                &.asst-nff-zero {
                    border-left: rem(5) solid $grants-line-color;
                }
                &.loan-file-c-outlay--zero,
                &.asst-file-c-outlay--zero,
                &.idv-file-c-outlay--zero,
                &.contract-file-c-outlay--zero {
                    margin-top: rem(20);
                    border-left: rem(5) solid $file-c-outlay;
                }
                border-right: none;
                margin-top: rem(10);
                @include display(flex);
                .award-amounts-viz__desc-text {
                    text-align: left;
                    order: 1;
                    margin-left: rem(10);
                    min-width: rem(160);
                    .award-amounts-viz__desc-text-wrapper {
                        @include display(flex);
                        @include justify-content(flex-end);
                        @include align-items(center);
                    }
                }
            }
        }
    }
}
